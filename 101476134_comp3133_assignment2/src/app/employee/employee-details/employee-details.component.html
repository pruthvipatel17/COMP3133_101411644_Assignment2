<div class="employee-details-container">
  <div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h1 class="mb-0"><i class="fas fa-user"></i> Employee Details</h1>
      <button class="btn btn-outline-primary" (click)="goBack()">
        <i class="fas fa-arrow-left"></i> Back to List
      </button>
    </div>

    <div class="card-body">
      <div class="alert alert-danger" *ngIf="errorMessage">
        <i class="fas fa-exclamation-circle"></i> {{ errorMessage }}
      </div>

      <div class="alert alert-success" *ngIf="successMessage">
        <i class="fas fa-check-circle"></i> {{ successMessage }}
      </div>

      <div class="loading-container text-center p-5" *ngIf="loading">
        <i class="fas fa-spinner fa-spin fa-3x"></i>
        <p class="mt-3">Loading employee details...</p>
      </div>

      <div *ngIf="!loading && employee">
        <!-- View Mode -->
        <div *ngIf="!isEditing">
          <div class="employee-profile">
            <div class="profile-header">
              <div class="profile-image">
                <img [src]="employee.employee_photo || 'https://via.placeholder.com/150'" alt="Employee Photo" class="rounded-circle">
              </div>
              <div class="profile-info">
                <h2>{{ employee.first_name }} {{ employee.last_name }}</h2>
                <p class="position">{{ employee.designation }}</p>
                <p class="department"><i class="fas fa-building"></i> {{ employee.department }}</p>
              </div>
            </div>

            <div class="profile-details mt-4">
              <div class="row">
                <div class="col-md-6">
                  <div class="detail-card">
                    <h3><i class="fas fa-user-circle"></i> Personal Information</h3>
                    <div class="detail-item">
                      <div class="detail-label"><i class="fas fa-envelope"></i> Email:</div>
                      <div class="detail-value">{{ employee.email }}</div>
                    </div>
                    <div class="detail-item">
                      <div class="detail-label"><i class="fas fa-venus-mars"></i> Gender:</div>
                      <div class="detail-value">{{ employee.gender }}</div>
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="detail-card">
                    <h3><i class="fas fa-briefcase"></i> Employment Information</h3>
                    <div class="detail-item">
                      <div class="detail-label"><i class="fas fa-building"></i> Department:</div>
                      <div class="detail-value">{{ employee.department }}</div>
                    </div>
                    <div class="detail-item">
                      <div class="detail-label"><i class="fas fa-id-badge"></i> Designation:</div>
                      <div class="detail-value">{{ employee.designation }}</div>
                    </div>
                    <div class="detail-item">
                      <div class="detail-label"><i class="fas fa-dollar-sign"></i> Salary:</div>
                      <div class="detail-value">${{ employee.salary }}</div>
                    </div>
                    <div class="detail-item">
                      <div class="detail-label"><i class="fas fa-calendar-alt"></i> Date of Joining:</div>
                      <div class="detail-value">{{ employee.date_of_joining | date }}</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="profile-actions mt-4">
              <button class="btn btn-primary mr-2" (click)="toggleEdit()">
                <i class="fas fa-edit"></i> Edit Employee
              </button>
              <button class="btn btn-danger" (click)="deleteEmployee()">
                <i class="fas fa-trash"></i> Delete Employee
              </button>
            </div>
          </div>
        </div>

        <!-- Edit Mode -->
        <form #employeeForm="ngForm" (ngSubmit)="onSubmit(employeeForm)" *ngIf="isEditing" class="edit-form">
          <div class="row">
            <div class="col-md-4 text-center mb-4">
              <div class="profile-image-edit">
                <img [src]="previewUrl || employee.employee_photo || 'https://via.placeholder.com/150'" alt="Employee Photo" class="rounded-circle">
              </div>
              <div class="form-group mt-3">
                <label for="employee_photo_file"><i class="fas fa-upload"></i> Upload Photo</label>
                <input 
                  type="file" 
                  id="employee_photo_file" 
                  class="form-control"
                  accept="image/*"
                  (change)="onFileSelected($event)"
                />
                <small class="text-muted">Select an image file to upload</small>
              </div>
              <div class="form-group mt-3">
                <label for="employee_photo"><i class="fas fa-image"></i> Photo URL:</label>
                <input type="text" id="employee_photo" name="employee_photo" [(ngModel)]="employee.employee_photo" class="form-control">
              </div>
            </div>
            <div class="col-md-8">
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="first_name"><i class="fas fa-user"></i> First Name:</label>
                    <input type="text" id="first_name" name="first_name" [(ngModel)]="employee.first_name" required class="form-control">
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="last_name"><i class="fas fa-user"></i> Last Name:</label>
                    <input type="text" id="last_name" name="last_name" [(ngModel)]="employee.last_name" required class="form-control">
                  </div>
                </div>
              </div>
              
              <div class="form-group">
                <label for="email"><i class="fas fa-envelope"></i> Email:</label>
                <input type="email" id="email" name="email" [(ngModel)]="employee.email" required class="form-control">
              </div>
              
              <div class="form-group">
                <label for="gender"><i class="fas fa-venus-mars"></i> Gender:</label>
                <select id="gender" name="gender" [(ngModel)]="employee.gender" required class="form-control">
                  <option value="Male">Male</option>
                  <option value="Female">Female</option>
                  <option value="Other">Other</option>
                </select>
              </div>
              
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="department"><i class="fas fa-building"></i> Department:</label>
                    <input type="text" id="department" name="department" [(ngModel)]="employee.department" required class="form-control">
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="designation"><i class="fas fa-id-badge"></i> Designation:</label>
                    <input type="text" id="designation" name="designation" [(ngModel)]="employee.designation" required class="form-control">
                  </div>
                </div>
              </div>
              
              <div class="form-group">
                <label for="salary"><i class="fas fa-dollar-sign"></i> Salary:</label>
                <input type="number" id="salary" name="salary" [(ngModel)]="employee.salary" required class="form-control">
              </div>
              
              <div class="form-group">
                <label for="date_of_joining"><i class="fas fa-calendar-alt"></i> Date of Joining:</label>
                <input type="date" id="date_of_joining" name="date_of_joining" [(ngModel)]="employee.date_of_joining" required class="form-control">
              </div>
            </div>
          </div>

          <div class="form-actions mt-4 text-right">
            <button type="button" class="btn btn-outline-secondary mr-2" (click)="toggleEdit()">
              <i class="fas fa-times"></i> Cancel
            </button>
            <button type="submit" class="btn btn-success" [disabled]="employeeForm.invalid || loading">
              <i class="fas fa-save"></i> Save Changes
            </button>
          </div>
        </form>
      </div>

      <div class="not-found text-center p-5" *ngIf="!loading && !employee && !errorMessage">
        <i class="fas fa-user-slash fa-3x text-secondary mb-3"></i>
        <p class="lead">Employee not found.</p>
        <button class="btn btn-primary mt-3" (click)="goBack()">
          <i class="fas fa-arrow-left"></i> Back to List
        </button>
      </div>
    </div>
  </div>
</div>
